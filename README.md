# Hyperspectral Attention Net (HAN)
This is the code repository for our paper: Weakly supervised deep learning for label-free identification and localization of drug fingerprints based on hyperspectral CARS microscopy.

## Overview
Understanding drug effects in complex biological samples is essential for the development of a drug. Hyperspectral coherent anti-Stokes Raman scattering (HS-CARS) microscopy, a label-free nondestructive chemical imaging technique, can profile biological samples based on their endogenous vibrational contrast. Here, we propose a deep learning-assisted HS-CARS imaging approach for the investigation of drug effect at single cell resolution. To identify and localize drug effect in complex biological systems, an attention-based deep neural network: Hyperspectral Attention Net (HAN), was developed. By formulating the drug effect localization into a Multiple Instance Learning task, HAN highlights informative regions through attention mechanism when being trained on whole-image labels. Using the proposed technique, we investigated the drug effect of a hepatitis B virus (HBV) therapy in mouse liver tissues. With the increase in drug dosage, higher classification accuracy was observed, with an average AUC of 0.942 for high-dose group, indicating an increased dissimilarity in the biomolecular profiles between control and higher-dosage drug-treated tissue samples. Besides, highly informative tissue structures predicted by HAN demonstrated a high-degree similarity with the drug In Situ Hybridization (ISH) staining results. These results demonstrate the potential of the proposed deep learning-assisted optical imaging technique for the label-free profiling, identification, and localization of the drug effect, which may facilitate the understanding of the distribution, metabolism, and underlying mechanism of action of the drug.

## System Environment
* Ubuntu 18.04
* Python
* Pytorch
* Nvidia GPU + CUDA

## Usage
(Will be updated)

## Main Results
(Will be updated)

## Citation
If you use this code and relecant data, please cite the corresponding paper where the original methods appeared.
(Will be updated)
